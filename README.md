# Бот для отметки токсичных сообщений
## Перед запуском
Для его работы необходимо создать телеграмм бота через @BotFather и указать переменную окружения с его токеном `BOT_TOKEN={YOUR_TOKEN}`   
## Сборка и запуск
из корня проекта `docker-compose up -d`   
## Взаимодействаие с проектом 
На порту `8501` находиться streamlit с интерфейсом для детального тестирования комантариев    
### Бот 
После создания бота можно либо написать ему сообщение, и от ответит токсиное оно или нет. Либо добавить его в чат, где он будет читать сообщения, а при опознаии токсичного будет отвечать на него с предупреждением.

# Описание структуры проекта
**3 контейнера:**

- **model_api:**   Сервис на FastAPI. Он загружает твою модель (PyTorch) и отдает REST API (принимает текст JSON, возвращает вероятность).

- **bot:**   Сервис на aiogram. Он ничего не знает про PyTorch (что экономит память), а просто шлет HTTP-запросы в model_api.

- **frontend:**   Сервис на Streamlit. Красивый веб-интерфейс для тестов, тоже шлет запросы в model_api.
---
## BOT:
Принцип работы бота в данной архитектуре можно разделить на **4 коротких этапа**:

1. **Перехват сообщения**: Бот (на базе `aiogram`) постоянно слушает обновления от серверов Telegram. Как только пользователь пишет сообщение, бот ловит его текст.
2. **Запрос к «мозгу» (API)**: Бот не анализирует текст сам (чтобы не тратить память). Он отправляет HTTP-запрос с этим текстом во второй контейнер — `model_api`.
3. **Инференс (Классификация)**: Внутри API модель **RuBERT** обрабатывает текст, превращает его в числа и выдает вероятность токсичности (от 0 до 1).
4. **Реакция**: API возвращает результат боту. Если вероятность выше порога (например, ), бот отправляет ответ пользователю: «Полегче!» или удаляет сообщение.

## MODEL_API
1. Загружает веса модели из памяти
2. При получении запроса прогоняет текст через модель и возвращает вероятность токсичности.
